## í…œí”Œë¦¿ ë©”ì†Œë“œ íŒ¨í„´

ì•Œê³ ë¦¬ì¦˜ì˜ ê³¨ê²©ì„ ì •ì˜í•˜ê³  ì„¸ë¶€ êµ¬í˜„ì€ ì„œë¸Œ í´ë˜ìŠ¤ì— ë§¡ê¸°ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.
í”„ë¡œì„¸ìŠ¤ì˜ ë‹¨ê³„ê°€ ëª…í™•í•˜ê³  ìˆœì„œê°€ ì¤‘ìš”í•œ ê²½ìš°ì— í…œí”Œë¦¿ ë©”ì†Œë“œë¥¼ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

ex) ì»¤í”¼ì™€ ì°¨ëŠ” ë¬¼ ë“ì´ê¸°ì™€ ì»µ ë”°ë¥´ê¸°ëŠ” ì¤‘ë³µë˜ëŠ” í–‰ë™ì…ë‹ˆë‹¤. ê³µí†µ ë¶€ë¶„ì„ ì¶”ìƒí™”í•˜ì—¬ ë² ì´ìŠ¤ í´ë˜ìŠ¤ë¡œ ë§Œë“­ë‹ˆë‹¤.

**ì¥ì **

- ì•Œê³ ë¦¬ì¦˜ì´ í•œ ê³³ì— ëª¨ì—¬ ìˆì–´ ìœ ì§€ë³´ìˆ˜ê°€ ìˆ˜ì›”í•©ë‹ˆë‹¤.
- ë‹¤ë¥¸ ì„œë¸Œí´ë˜ìŠ¤ì—ì„œ ì½”ë“œ ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤
- ë‹¤ë¥¸ ìŒë£Œë¥¼ ì¶”ê°€í•  ë•Œë„ ëª‡ ê°€ì§€ ë©”ì†Œë“œë§Œ ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.

ìë°”ì—ì„œëŠ” ì •ì˜í•˜ëŠ” ë‹¨ê³„ì—ì„œ `final`ë¡œ ì„ ì–¸í•˜ì—¬ ê° ë‹¨ê³„ë¥¼ ê³ ì •í•©ë‹ˆë‹¤.
ë‹¨, ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œëŠ” `final`ì´ ì—†ì–´ì„œ ì™„ë²½í•˜ê²Œ ì˜¤ë²„ë¼ì´ë“œë¥¼ ë§‰ì„ ìˆ˜ëŠ” ì—†ì–´ ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì˜ë„ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤

1. ì£¼ì„ìœ¼ë¡œ ì˜ë„ë¥¼ í‘œí˜„

```js
abstract class Beverage {
    /**
     *  í…œí”Œë¦¿ ë©”ì†Œë“œ - ì˜¤ë²„ë¼ì´ë“œ í•˜ì§€ë§ˆì„¸ìš”~~
     * @final
     */
    prepareBeverage() : void {
        this.boilWater()
        this.brew()
        this.pourIncup()
    }

    abstract brew():void;
}
```

2. Private + Static

```js
abstract class Beverage {
  // í…œí”Œë¦¿ ë©”ì„œë“œë¥¼ finalì²˜ëŸ¼ ë§Œë“¤ê¸°
  final_prepareBeverage(): void {
    this.boilWater();
    this.brew();
    this.pourInCup();
  }

  abstract brew(): void;

  protected boilWater(): void {
    console.log('ë¬¼ ë“ì´ê¸°');
  }

  protected pourInCup(): void {
    console.log('ì»µì— ë”°ë¥´ê¸°');
  }
}

class Coffee extends Beverage {
  // final_prepareBeverageëŠ” ë„¤ì´ë°ìœ¼ë¡œ "ê±´ë“œë¦¬ì§€ ë§ë¼"ëŠ” ì˜ë„ í‘œí˜„

  brew(): void {
    console.log('ì»¤í”¼ ìš°ë¦¬ê¸°');
  }

  // ì‹¤ìˆ˜ë¡œ ì˜¤ë²„ë¼ì´ë“œí•˜ë©´ ë°”ë¡œ ì•Œ ìˆ˜ ìˆìŒ
  // final_prepareBeverage(): void {  // ì´ë¦„ì´ ì´ìƒí•´ì„œ ì˜ì‹¬í•˜ê²Œ ë¨
  //   ...
  // }
}
```

3. Object.freeze()ë¡œ ëŸ°íƒ€ì„ ë³´í˜¸

```js
abstract class Beverage {
  constructor() {
    // í…œí”Œë¦¿ ë©”ì„œë“œë¥¼ freeze
    Object.freeze(this.prepareBeverage);
  }

  prepareBeverage(): void {
    this.boilWater();
    this.brew();
    this.pourInCup();
  }

  abstract brew(): void;
  protected abstract boilWater(): void;
  protected abstract pourInCup(): void;
}

class Coffee extends Beverage {
  // ì´ë ‡ê²Œ ì˜¤ë²„ë¼ì´ë“œí•´ë„...
  prepareBeverage(): void {
    console.log('ë¬´ì‹œ!');
  }

  brew(): void {
    console.log('ì»¤í”¼');
  }
}

const coffee = new Coffee();
// freezeëœ ë©”ì„œë“œëŠ” ë³€ê²½ ë¶ˆê°€
coffee.prepareBeverage = function() { console.log('í•´í‚¹!'); }; // strict modeì—ì„œ ì—ëŸ¬
```

4. Proxyë¥¼ ì‚¬ìš©í•œ ë³´í˜¸

```js
abstract class Beverage {
  prepareBeverage(): void {
    this.boilWater();
    this.brew();
    this.pourInCup();
  }

  abstract brew(): void;
  protected boilWater(): void { console.log('ë¬¼ ë“ì´ê¸°'); }
  protected pourInCup(): void { console.log('ì»µì— ë”°ë¥´ê¸°'); }
}

// Proxyë¡œ ê°ì‹¸ê¸°
function createFinalTemplate<T extends Beverage>(BeverageClass: new () => T): T {
  const instance = new BeverageClass();
  const originalMethod = instance.prepareBeverage.bind(instance);

  return new Proxy(instance, {
    get(target, prop) {
      if (prop === 'prepareBeverage') {
        return originalMethod; // í•­ìƒ ì›ë³¸ ë©”ì„œë“œ ë°˜í™˜
      }
      return target[prop as keyof T];
    },
    set(target, prop, value) {
      if (prop === 'prepareBeverage') {
        throw new Error('prepareBeverageëŠ” final ë©”ì„œë“œì…ë‹ˆë‹¤!');
      }
      target[prop as keyof T] = value;
      return true;
    }
  });
}

class Coffee extends Beverage {
  brew(): void { console.log('ì»¤í”¼'); }

  // ì˜¤ë²„ë¼ì´ë“œ ì‹œë„
  prepareBeverage(): void {
    console.log('í•´í‚¹ ì‹œë„!');
  }
}

const coffee = createFinalTemplate(Coffee);
coffee.prepareBeverage(); // ì›ë³¸ ë©”ì„œë“œ ì‹¤í–‰ë¨!
```

5. ì»´í¬ì§€ì…˜ ì‚¬ìš©

```js
// í…œí”Œë¦¿ ë©”ì„œë“œë¥¼ í´ë˜ìŠ¤ ë°–ìœ¼ë¡œ
class BeverageTemplate {
  // ì´ê±´ ì§„ì§œ final - ì˜¤ë²„ë¼ì´ë“œ ë¶ˆê°€ëŠ¥
  static prepare(strategy: BeverageStrategy): void {
    BeverageTemplate.boilWater();
    strategy.brew();
    BeverageTemplate.pourInCup();
    strategy.addCondiments();
  }

  private static boilWater(): void {
    console.log('ë¬¼ ë“ì´ê¸°');
  }

  private static pourInCup(): void {
    console.log('ì»µì— ë”°ë¥´ê¸°');
  }
}

// ì „ëµ ì¸í„°í˜ì´ìŠ¤
interface BeverageStrategy {
  brew(): void;
  addCondiments(): void;
}

// êµ¬í˜„ì²´
class CoffeeStrategy implements BeverageStrategy {
  brew(): void {
    console.log('ì»¤í”¼ ìš°ë¦¬ê¸°');
  }

  addCondiments(): void {
    console.log('ì„¤íƒ•ê³¼ ìš°ìœ  ì¶”ê°€');
  }
}

class TeaStrategy implements BeverageStrategy {
  brew(): void {
    console.log('í‹°ë°± ìš°ë¦¬ê¸°');
  }

  addCondiments(): void {
    console.log('ë ˆëª¬ ì¶”ê°€');
  }
}

// ì‚¬ìš© - í…œí”Œë¦¿ì€ ì ˆëŒ€ ë³€ê²½ ë¶ˆê°€!
BeverageTemplate.prepare(new CoffeeStrategy());
BeverageTemplate.prepare(new TeaStrategy());
```

### í…œí”Œë¦¿ ë©”ì†Œë“œ ì† í›„í¬

í›„í¬(hook)ëŠ” ì¶”ìƒ í´ë˜ìŠ¤ì—ì„œ ì„ ì–¸ë˜ì§€ë§Œ ê¸°ë³¸ì ì¸ ë‚´ìš©ë§Œ êµ¬í˜„ë˜ê±°ë‚˜ ì•„ë¬´ ì½”ë“œë„ ë“¤ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.
-> ì„œë¸Œí´ë˜ìŠ¤ëŠ” ë‹¤ì–‘í•œ ìœ„ì¹˜ì—ì„œ ì•Œê³ ë¦¬ì¦˜ì— ë¼ì–´ë“¤ê±°ë‚˜ ë„˜ì–´ê°ˆ ìˆ˜ ìˆë‹¤.

í›„í¬ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì„œë¸Œ í´ë˜ìŠ¤ì—ì„œ í›„í¬ë¥¼ ì˜¤ë²„ë¼ì´ë“œí•©ë‹ˆë‹¤.

```js
abstract class Beverage {
  // í…œí”Œë¦¿ ë©”ì„œë“œ
  prepareBeverage(): void {
    this.boilWater();
    this.brew();              // ì¶”ìƒ ë©”ì„œë“œ - ë°˜ë“œì‹œ êµ¬í˜„
    this.pourInCup();

    // í›… ë©”ì„œë“œ - ì„ íƒì ìœ¼ë¡œ ì˜¤ë²„ë¼ì´ë“œ
    if (this.customerWantsCondiments()) {  // ğŸ‘ˆ ì´ê²Œ í›…!
      this.addCondiments();   // ì¶”ìƒ ë©”ì„œë“œ - ë°˜ë“œì‹œ êµ¬í˜„
    }
  }

  // ê³µí†µ ë©”ì„œë“œ
  boilWater(): void {
    console.log('ë¬¼ ë“ì´ê¸°');
  }

  pourInCup(): void {
    console.log('ì»µì— ë”°ë¥´ê¸°');
  }

  // ì¶”ìƒ ë©”ì„œë“œ - ì„œë¸Œí´ë˜ìŠ¤ê°€ ë°˜ë“œì‹œ êµ¬í˜„í•´ì•¼ í•¨
  abstract brew(): void;
  abstract addCondiments(): void;

  // ğŸ‘‡ í›… ë©”ì„œë“œ - ê¸°ë³¸ êµ¬í˜„ ì œê³µ, ì˜¤ë²„ë¼ì´ë“œëŠ” ì„ íƒ
  customerWantsCondiments(): boolean {
    return true; // ê¸°ë³¸ê°’: ì²¨ê°€ë¬¼ ì¶”ê°€
  }
}
```

=> í›„í¬ëŠ” ì•Œê³ ë¦¬ì¦˜ì—ì„œ í•„ìˆ˜ì ì´ì§€ ì•Šì€ ë¶€ë¶„ì„ ì„œë¸Œí´ë˜ìŠ¤ì—ì„œ êµ¬í˜„í•˜ë„ë¡ ë§Œë“¤ê³  ì‹¶ì„ ë•Œ
=> í…œí”Œë¦¿ ë©”ì†Œë“œì—ì„œ ì•ìœ¼ë¡œ ì¼ì–´ë‚  ì¼ì´ë‚˜ ë§‰ ì¼ì–´ë‚œ ì¼ì— ì„œë¸Œí´ë˜ìŠ¤ê°€ ë°˜ì‘í•  ìˆ˜ ìˆëŠ” ê¸°íšŒë¥¼ ì œê³µ

### í• ë¦¬ìš°ë“œ ì›ì¹™

Don't call us, we'll call you
í• ë¦¬ìš°ë“œ ì›ì¹™ì„ í™œìš©í•˜ì—¬ ì˜ì¡´ì„± ë¶€íŒ¨ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
==> ë°°ìš°ëŠ” ê°ë…ì´ ë¶€ë¥¼ ë•Œë§Œ ë°˜ì‘í•œë‹¤.

í…œí”Œë¦¿ ë©”ì†Œë“œ íŒ¨í„´ì´ í•´ë‹¹ ì›ì¹™ì„ ì˜ ì§€í‚¤ëŠ” ì¼€ì´ìŠ¤ì…ë‹ˆë‹¤.

**ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì˜ˆì‹œ**

```js
// âŒ í• ë¦¬ìš°ë“œ ì›ì¹™ ìœ„ë°˜
function badEventHandling() {
  while (true) {
    if (button.isClicked()) {
      // ê³„ì† í™•ì¸
      handleClick();
    }
  }
}

// âœ… í• ë¦¬ìš°ë“œ ì›ì¹™ ì¤€ìˆ˜
button.addEventListener("click", () => {
  // ë¸Œë¼ìš°ì €ê°€ ë¶€ë¥¼ ë•Œë§Œ ì‹¤í–‰
  console.log("í´ë¦­ë¨!");
});

// ë¸Œë¼ìš°ì €ê°€ í´ë¦­ ê°ì§€í•˜ë©´ ì½œë°± í˜¸ì¶œ
// ìš°ë¦¬ëŠ” ê³„ì† í™•ì¸í•  í•„ìš” ì—†ìŒ!
```

**í• ë¦¬ìš°ë“œ ì›ì¹™ì˜ ì¥ì **

1. ì œì–´ì˜ ì—­ì „(IoC - Inversion of Control)

```js
// ì¼ë°˜ì ì¸ íë¦„: í•˜ìœ„ê°€ ìƒìœ„ í˜¸ì¶œ
class Low {
  doSomething() {
    const result = High.getData();  // í•˜ìœ„ê°€ ìƒìœ„ í˜¸ì¶œ
    this.process(result);
  }
}

// í• ë¦¬ìš°ë“œ ì›ì¹™: ìƒìœ„ê°€ í•˜ìœ„ í˜¸ì¶œ
abstract class High {
  execute() {
    const data = this.getData();
    this.process(data);  // ìƒìœ„ê°€ í•˜ìœ„ í˜¸ì¶œ
  }
  abstract process(data: any): void;
}
```

2. ê²°í•©ë„ ê°ì†Œ

- í•˜ìœ„ í´ë˜ìŠ¤ëŠ” ìƒìœ„ í´ë˜ìŠ¤ì˜ ë‚´ë¶€ êµ¬ì¡°ë¥¼ ëª°ë¼ë„ ë©ë‹ˆë‹¤.
- ìƒìœ„ í´ë˜ìŠ¤ë§Œ ì „ì²´ íë¦„ì„ ì•Œë©´ ëœë‹¤.

3. ì¬ì‚¬ìš©ì„± ã…ˆìœ¼ê°€

- í•˜ìœ„ í´ë˜ìŠ¤ëŠ” ì„¸ë¶€ êµ¬í˜„ë§Œ ì‹ ê²½ì“°ë©´ëœë‹¤.
